# 📊 TradeXST：設計ドキュメント

---
## 🧱技術スタック

|要素|内容|
|---|---|
|**React (Next.js)**|高速なSPA/SSR対応UI構築。チャート操作・フォーム構築・状態管理に最適。Tailwindと組み合わせてUX強化|
|**FastAPI**|Pythonとの親和性が高く、非同期処理（async）で並列検証にも強い。ロジック/APIの分離がしやすく保守性も高い|
|**Python**|Pandas・NumPy・TA-Libで検証ロジックを記述。Celery + Redisで並列処理。重検証タスクの基幹言語|
|**ClickHouse**|Parquetとの相性も良く、DuckDBでは難しいマルチユーザー対応や高速OLAP分析が可能。大規模検証の結果処理にも対応|
|**Supabase**|PostgreSQLベースのBaaS。ユーザーデータ・保存条件・認証などをスケーラブルに管理可能|
|**Cloudflare**|Pagesで静的配信、R2でParquet保存、Workersで軽量API処理。S3互換ストレージ・グローバルCDNでコストパフォーマンスも◎|
|**Stripe**|サブスク課金管理に最適。Webhookや署名検証で不正課金も防げる|
|**Auth0 / Firebase Auth**|ログイン・ロール管理・JWTトークン発行によるセキュアなAPIアクセス制御に対応|
|**Sentry / LogRocket**|エラー監視・UXログ収集・ユーザー操作のトラッキング。障害対応と継続的改善に不可欠|
|**GitHub Actions**|CI/CD自動化。コード変更→テスト→デプロイまでを自動化し、品質とスピードを両立|

## 🔁 各技術の関係性（依存と接続）

| 技術             | 接続先 / 関係                   | 役割            |
| -------------- | -------------------------- | ------------- |
| React          | FastAPI（API）               | UI→ロジック呼び出し   |
| FastAPI        | Celery / Supabase / Stripe | 処理制御・検証トリガー   |
| Celery         | Python検証関数 / Redis         | 並列処理の実行       |
| Python検証       | Parquet / TA-Lib           | 実際の検証アルゴリズム   |
| Supabase       | React / FastAPI            | 保存・制限情報取得     |
| ClickHouse     | FastAPI / 分析用              | 高速な集計処理・履歴取得  |
| Cloudflare R2  | Python                     | チャートデータ保存と読取  |
| Auth0/Firebase | React / FastAPI            | 認証制御          |
| Stripe         | FastAPI                    | 課金管理 + 使用制限制御 |
## ✍️ 要点まとめ

- **React** がUIを提供し、条件を FastAPI に送信。
    
- **FastAPI** はそれを Python + Celery に流し込み、非同期で検証。
    
- 過去データは **Cloudflare R2** から読み出し、結果を **Supabase** に保存。
    
- **ClickHouse** は統計・KPIのために検証履歴を集計。
    
- **Auth0 / Stripe** でセキュリティとプラン制御を担保。
    
- 全体を **GitHub Actions + Sentry** で自動化・監視。


## 🔧 機能設計（Feature Design）

### 📌 コア機能（必須）

- 検証ルール設定（インジケーター、条件分岐）
- チャート表示（ロウソク・ライン・インジ）
- バックテスト実行（1クリック）
- 検証履歴保存
- 検証中のアニメーション（どこでエントリーしてどういう風に勝敗が決まったのか）
- コミュニティ機能（トレーディングビューのノート機能みたいな感じ）MVPの段階ではいらないかも？
- アカウント機能
- 手動裁量検証モード
- 並列処理検証
- 早送り巻き戻しリアルタイム再生
- 結果サマリーのクラウド保存

---

### 🖥️ ユーザーインターフェース

- レスポンシブ設計（Web & デスクトップ）
- 視覚的なチャート操作（ズーム・パン）
- 結果サマリーの可視化（勝率、PF、ドローダウン）
-

---

### 💾 データ処理

- 過去チャートデータのサーバー処理
---

### 🔐 セキュリティ

- **API制御・不正利用対策**
- **検証ロジックの暗号化・保護**
- **インジェクション & XSS対策**
- **ペイメント周り**
- 課金プランによる使用制限の実装（６０秒でタイムアウトなど

---

## 💼 ビジネス設計（Business Design）

### 🎯 ターゲット

- 世界中の個人FXトレーダー（中級者〜プロ）
- EA開発者 / 法人トレーダー
- 狙いとしては法人やEA開発者などのリテラシーが高い層ではなく、「トレーダーとして稼ぎまくって自分はインテリ系のトレーダーとして食っていくんだ！と熱がある情弱トレーダー。数学とかに弱くプログラミングもできない層やね。」
- このプロダクト自体がGUIで条件を定義できて非プログラマーでも条件設定をできるのでそういう層がメインになってくる。

---

### 💳 プラン設計

| プラン        | 月額     | 自動バックテスト | 裁量モード | 描画数  | 並列処理 | クラウド保存   | 想定ユーザー      |
| ---------- | ------ | -------- | ----- | ---- | ---- | -------- | ----------- |
| 🟢 フリー     | ¥0     | 3回/日     | 無制限   | 1画面  | 1個   | 最大10件    | お試し・初心者     |
| 🔵 ベーシック   | ¥3,980 | 20回/日    | 無制限   | 4画面  | 2個   | 最大100件   | 個人トレーダー     |
| 🟣 プレミアム   | ¥5,980 | 60回/日    | 無制限   | 10画面 | 4個   | 最大1,000件 | 本気で勝ちにいく中級者 |
| 🟠 アンリミテッド | ¥9,980 | 無制限      | 無制限   | 16画面 | 8個   | 無制限      | EA開発・法人     |

---

### 📣 集客・販促

- 無料プランでリード獲得 → サブスク誘導
- LP + SNS（X・YouTube・note）
- 「EA製作を爆速化できる」等の刺さる訴求文

---

### 🔁 LTV戦略

- ユーザー保存データのクラウド同期（プレミアム特典）
- 定期的な機能追加とアップグレード通知
- コミュニティ機能
- 紹介機能
---

### 📈 KPI管理

- CVR（無料→有料）
- 検証回数と継続率の相関分析
- 国別アクティブユーザー分布
- 離脱ポイント
- 
