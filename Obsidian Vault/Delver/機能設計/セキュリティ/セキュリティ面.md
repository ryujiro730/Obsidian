### 1. **API制御・不正利用対策**

- Firebase Auth or Auth0で認証
    
- 各プランに応じて、Cloud Functions側でRate Limiting（例：60回/日）
    
- トークンベースで検証リクエストに署名（JWT）
    

### 2. **検証ロジックの暗号化・保護**

- クラウド保存時にAES暗号化（ユーザーごとに鍵分離）
    
- ローカルStorageには保存しない（ブラウザに残らない設計）
    

### 3. **インジェクション & XSS対策**

- 検証条件の入力UIはカスタムコンポーネントで構築（生文字列禁止）
    
- `DOMPurify`でHTMLサニタイズ
    
- チャート上のノート機能やコメントも要フィルタリング
    

### 4. **ペイメント周り**

- Stripeを採用（セキュア & 国内対応）
    
- Webhook側の署名検証を厳密に（不正課金・ロール昇格対策）